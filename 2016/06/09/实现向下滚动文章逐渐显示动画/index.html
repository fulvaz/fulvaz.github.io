<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="author" content="Fulvaz"><meta name="description" content="我只是个混github连击的"><title>实现向下滚动文章逐渐显示动画 | Fulvaz PlayGroud</title><link href="/favicon.png" rel="icon"><link rel="alternate" href="/atom.xml" title="Fulvaz PlayGroud" type="application/atom.xml"><link href="http://fonts.useso.com/css?family=Open+Sans:400" rel="stylesheet"><link href="http://fonts.useso.com/css?family=Source+Code+Pro:400,600" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/stylesheets/app.css"></head><body><nav class="slide-menu"><div class="container"><div id="slide-introduction"><section id="slide-avator"></section><section id="slide-name"><p>Fulvaz</p></section><section id="slide-introduction-content"><p>半路出家伪文艺码农</p></section><section id="slide-contacts"></section></div><ul><li><a href="/about">About</a></li><li><a href="/archives">Archive</a></li><li><a href="https://github.com/subuta/hexo-jade-sass-barebone">Source</a></li></ul></div></nav><section id="top-head"><div id="top-head-wraper"><a href="/">Fulvaz PlayGroud</a><i id="top-head-menu-button" aria-hidden="true" class="fa fa-bars"></i></div></section><div class="wrapper"><header id="page-header"><div class="header-background-container"><video loop="true" mute="true" autoplay="true" poster="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/images/header-background.jpg" class="header-background-video"><source src="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/videos/Blurry-Lights.webm" type="video/webm"><source src="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/videos/Blurry-Lights.mp4" type="video/mp4"><source src="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/videos/Blurry-Lights.ogv" type="video/ogv"></video></div><div class="header-background-shelter"></div><div id="masthead"><div class="wrapper"><h1 id="site-title">Fulvaz PlayGroud</h1><p id="description">我只是个混github连击的</p></div></div></header><section id="content"><article class="post"><div class="article-head"><h2 class="article-title">实现向下滚动文章逐渐显示动画</h2><div class="meta article-date">2016-06-09</div></div><div class="article-content markdown-body"><p><p>其实基本参考文末链接文章做的, 只是那篇文章实在写得太简略, 我将文章扩展开</p><p>效果见<a href="http://fulvaz.github.io/">http://fulvaz.github.io/</a> (只支持最新版本的chrome浏览 : P)<br><a id="more"></a></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>我们需要实现向下滚屏时, 文章逐渐显示出来, 那么就有几点需要完成:</p><ol><li>滚动到文章位置播放动画</li></ol><ul><li><p>判断滚动到文章位置, 即文章此时可见</p></li><li><p>播放动画</p></li></ul><ol><li>补充: 不要重复播放动画</li></ol><h2 id="干活"><a href="#干活" class="headerlink" title="干活!"></a>干活!</h2><h3 id="判断文章是否显示了"><a href="#判断文章是否显示了" class="headerlink" title="判断文章是否显示了"></a>判断文章是否显示了</h3><p>判断方法:<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">element</span><span class="selector-class">.getBoundingClientRect</span>()<span class="selector-class">.top</span> &lt; <span class="selector-tag">window</span><span class="selector-class">.innerHeight</span>);</span><br></pre></td></tr></table></figure><p></p><p><code>getBoundingClientRect()</code>可以获取该元素与可视区域上下左右的距离, 即元素不可见的时候, 依然会有数值, 一图胜千言:<br><img title="getBoundingClientRect说明" alt="getBoundingClientRect说明" src="http://7xp7jw.com1.z0.glb.clouddn.com/static/images/getBoundingClientRect.jpg?imageView2/2/w/600"></p><p>即element上边框和可是区域上边框的距离即是top, 至于element在可视区域上方或者下方时的值, 大家可以自己试验</p><p>我们需要的是, 当element刚出现的时候就播放动画, 那么只要top的值小于window.innerHeight时, 我们就可以说element出现了, 那么r就播放动画.</p><h3 id="播放动画"><a href="#播放动画" class="headerlink" title="播放动画"></a>播放动画</h3><p>动画我使用css3的animation属性完成</p><p>首先需要找一段动画, 我提供一段, 把这段动画放到css里面<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@-<span class="keyword">webkit</span>-<span class="keyword">keyframes</span> fadeInDown &#123;</span><br><span class="line">0% &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(-20px);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-20px);</span><br><span class="line">&#125;</span><br><span class="line">100% &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(0);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(0);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">keyframes</span> fadeInDown &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(-20px);</span><br><span class="line">    <span class="attribute">-ms-transform</span>: <span class="built_in">translateY</span>(-20px);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-20px);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(0);</span><br><span class="line">    <span class="attribute">-ms-transform</span>: <span class="built_in">translateY</span>(0);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(0);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fadeInDown</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-name</span>: fadeInDown;</span><br><span class="line">  <span class="attribute">animation-name</span>: fadeInDown;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>播放动画的方法很简单, 新建一个类如下, 添加了这个类的元素都会播放动画<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.animated</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: <span class="number">1s</span> fadeInDown;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>利用这个原理, 在js中, 当判断到element已经出现, 就添加<code>animated</code>类</p><p>顺便解决了下面的问题</p><h3 id="只播放一次动画"><a href="#只播放一次动画" class="headerlink" title="只播放一次动画"></a>只播放一次动画</h3><p>同一个class不能添加两次, 动画只能播一次</p><h3 id="那些元素会播放动画"><a href="#那些元素会播放动画" class="headerlink" title="那些元素会播放动画?"></a>那些元素会播放动画?</h3><p>class为<code>reveal-detect</code>的元素</p><h2 id="完整js代码"><a href="#完整js代码" class="headerlink" title="完整js代码"></a>完整js代码</h2><p>对, 就只有这么多</p><p>有趣的是:<code>.reveal-detect:not(.animated)</code> 获取不含有animated类, 但含有reveal-detect类的元素<br></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">window</span><span class="selector-class">.addEventListener</span>(<span class="string">'scroll'</span>, () =&gt; &#123;</span><br><span class="line">    var revealDetect = document<span class="selector-class">.querySelectorAll</span>(<span class="string">'.reveal-detect:not(.animated)'</span>);</span><br><span class="line">    revealDetect = <span class="selector-attr">[]</span><span class="selector-class">.slice</span><span class="selector-class">.call</span>(revealDetect);  <span class="comment">// may improve some performance? </span></span><br><span class="line">    for(let i=0; i&lt;revealDetect<span class="selector-class">.length</span>; <span class="selector-tag">i</span>++) &#123;</span><br><span class="line">        <span class="selector-tag">if</span>(revealDetect[i].getBoundingClientRect().top &lt; window.innerHeight) &#123;</span><br><span class="line">            revealDetect<span class="selector-attr">[i]</span><span class="selector-class">.classList</span><span class="selector-class">.add</span>(<span class="string">'animated'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><h2 id="你也可以…"><a href="#你也可以…" class="headerlink" title="你也可以…"></a>你也可以…</h2><p>直接使用我的代码 <a href="https://github.com/fulvaz/TriggerAnimationOnScroll" target="_blank" rel="external">https://github.com/fulvaz/TriggerAnimationOnScroll</a></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://blog.webbb.be/trigger-css-animation-scroll/" target="_blank" rel="external">http://blog.webbb.be/trigger-css-animation-scroll/</a></p></p></div></article></section><nav id="article-list-pagination"><a href="/2016/06/14/重构之痛/" title="上一页 article: 重构之痛" class="prev">&larr; 上一页</a><a href="/2016/06/02/haha/" title="下一页 article: haha" class="next">下一页 &rarr;</a></nav><footer id="page-footer"><nav id="footer-menu"><ul><li><a href="/about">About</a></li><li><a href="/archives">Archive</a></li><li><a href="https://github.com/fulvaz/hexo-theme">Source</a></li></ul></nav></footer></div><script src="http://upcdn.b0.upaiyun.com/libs/jquery/jquery-2.0.3.min.js"></script><script src="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/script/futil.min.js"></script><script src="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/script/app_0.1.min.js"></script></body></html>