<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="author" content="Fulvaz"><meta name="description" content="我只是个混github连击的"><title>Fulvaz PlayGroud</title><link href="/favicon.png" rel="icon"><link rel="alternate" href="/atom.xml" title="Fulvaz PlayGroud" type="application/atom.xml"><link href="http://fonts.lug.ustc.edu.cn/css?family=Open+Sans:400" rel="stylesheet"><link href="http://fonts.lug.ustc.edu.cn/css?family=Source+Code+Pro:400,600" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/stylesheets/app.css"></head><body><nav class="slide-menu"><div class="container"><div id="slide-introduction"><section id="slide-avator"></section><section id="slide-name"><p>Fulvaz</p></section><section id="slide-introduction-content"><p>半路出家伪文艺码农</p></section><section id="slide-contacts"></section></div><ul><li><a href="/about">About</a></li><li><a href="/archives">Archive</a></li><li><a href="https://github.com/subuta/hexo-jade-sass-barebone">Source</a></li></ul></div></nav><section id="top-head"><div id="top-head-wraper"><a href="/">Fulvaz PlayGroud</a><i id="top-head-menu-button" aria-hidden="true" class="fa fa-bars"></i></div></section><div class="wrapper"><header id="page-header"><div class="header-background-container"><video loop="true" mute="true" autoplay="true" poster="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/images/header-background.jpg" class="header-background-video"><source src="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/videos/Blurry-Lights.webm" type="video/webm"><source src="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/videos/Blurry-Lights.mp4" type="video/mp4"><source src="http://7xp7jw.com1.z0.glb.clouddn.com/myTheme/static/videos/Blurry-Lights.ogv" type="video/ogv"></video></div><div class="header-background-shelter"></div><div id="masthead"><div class="wrapper"><h1 id="site-title">Fulvaz PlayGroud</h1><p id="description">我只是个混github连击的</p></div></div></header><section id="content"><ul class="article-list"><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2017/06/24/实现向下滚动文章逐渐显示动画/">实现向下滚动文章逐渐显示动画</a></h2><div class="meta article-date">2017-06-24</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:59 GMT+0800 (CST) --><p>其实基本参考文末链接文章做的, 只是那篇文章实在写得太简略, 我将文章扩展开</p><p>效果见<a href="http://fulvaz.github.io/">http://fulvaz.github.io/</a> (只支持最新版本的chrome浏览 : P)</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>我们需要实现向下滚屏时, 文章逐渐显示出来, 那么就有几点需要完成:<br>1 滚动到文章位置播放动画<br>2 判断滚动到文章位置, 即文章此时可见<br>3 播放动画<br>2 补充: 不要重复播放动画</p><a id="more"></a><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/10/15/TOO-MANY-JS-FRAMEWORK/">[翻译]前端框架多不是件好事吗?</a></h2><div class="meta article-date">2016-10-15</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><h2 id="文章信息"><a href="#文章信息" class="headerlink" title="文章信息"></a>文章信息</h2><p>原文：<a href="http://mrmrs.io/writing/2015/07/27/too-many-tools/?utm_source=wanqu.co&amp;utm_campaign=Wanqu+Daily&amp;utm_medium=website" target="_blank" rel="external">http://mrmrs.io/writing/2015/07/27/too-many-tools/?utm_source=wanqu.co&amp;utm_campaign=Wanqu+Daily&amp;utm_medium=website</a></p><p>原文创作日期: 2015年7月27日</p><p>原标题: TOO MANY TOOLS AND FRAMEWORKS</p><p>原文作者: <a href="https://github.com/mrmrs" target="_blank" rel="external">mrmrs</a></p><p>翻译: 失眠的fulvaz</p><h2 id="译文"><a href="#译文" class="headerlink" title="译文"></a>译文</h2><p>Theodore Sturgeon是一名科幻小说, 评论家. Kurt Vonnegut笔下角色Kilgore Trout便是以Theodore Sturgeon为原型.Theodore Sturgeon非常高产, 著有超过200部作品, 发表超过400篇评论.他的第一部作品发布于1939年 – 科幻小说并不被文学圈广泛接受的年代.</p><p>1958年, Theodore Sturgeon在Venture proclaiming发布了自己的作品&lt;Sturgeon’s Revelation&gt;(Sturgeon的启示录):</p><blockquote><p>(高能提醒: 大量意译)我重提&lt;Sturgeon’s Revelation&gt;是因为, 我已经已经有20年时间花在与人辩解科幻小说的地位上. 反对者们老是使用最差的科幻小说作品作为例子, 然后得出科幻小说是垃圾的结论. 我感到很厌倦. 按他们的意思, 如果某一领域出现了垃圾的话, 那么这领域90%的内容都是垃圾. 这么说, 90%的电影, 文学作品, 消费产品都是垃圾. 这种说法是根本站不住脚的, 因为科幻小说作品质量的发展趋势和其他艺术作品是一样的. 科幻小说需要时间发展.</p></blockquote><p>在湾区, 随便往那一站, 就会听到两个程序员在吐槽2015年js框架多得令人发指, 而且这些框架还毫无意义地增加了开发的复杂度. 在twitter上搜索<code>&#39;too many js tools&#39; or &#39;yet another js framework&#39;</code>(js工具太多 or 我做了一个js框架), 搜索结果是一堆人对当前状况的哀嚎.</p><p>这样抱怨对js社区并没有好处, 甚至是有害. 我们不能因为出现了烂工具, 而停止对工具和框架的追求. 举个例子, 一天出版的新书, 比我一辈子读的书还要多. 但我会为这件事感到忧伤, 甚至是焦虑吗? 我不会读全部书, 但是读到好书我会感到非常开心, 甚至是兴奋. 所以, 我们应该将抱怨向前推进一步 — 讨论我们该怎么制作更好的工具, 更好的工具应该是什么样的, 而不是对工具变多而感到焦虑.</p><blockquote><p>“Four–fifths of everybody’s work must be bad. But the remnant is worth the trouble for its own sake.”</p><p>- Rudyard Kipling in 1890</p><p>翻译: 五分之四的人作品都是垃圾, 但是剩下的作品花时间值得去挑选.</p></blockquote><p>Rudyard Kipling于1890年去世, 59年后Javascript诞生. 然而, 他很有可能讨论过js框架. 在音乐, 艺术, 照相领域里面, 发布最烂的作品毫无意义. 因此, 大多数人都会将自己的次品藏起来. 然而, 我们甚少会将自己最差的代码藏起来. 至少在我的经历中, 开发过程中并不会将差代码藏起来. 但是并不是说这这是件坏事, 这种公开过程的工作方式让其他人能够参考学习. 我们需要这种工作方式.</p><p>开发与科研, 数学, 艺术, 音乐, 摄像并没有什么不同, 这些都是需要人们创造性地解决问题的领域. 这些领域都充满了困难, 而且耗费时间. 我们会边学习边改进解决方案. 爱迪生花了超过1年的时间去制作灯泡的原型. 他获得专利后, 还继续研究灯丝材料, 用来改进自己灯泡的设计. 即使是在现在–2015年, 我们仍然在改进灯泡的设计. 在amazon上搜索<code>灯泡</code>会返回150,858个结果. 有非常多公司还在尝试解决各种各样灯泡的问题. 这些公司还在想法提高灯泡的品质, 可使用时间, 能效, 减少制作成本.</p><p>总有人在呼吁不要再去做新的js框架, 叫人家不要去开发那么多新工具. 我与他们相反, 我鼓励各位制作更多工具. 找到一个问题, 然后用比其他人更好的方法去解决. 拥有更多的工具会将互联网向前推进. 90%的作品都是垃圾没有关系. 有剩下10%的精华就够了.</p><h2 id="个人理解"><a href="#个人理解" class="headerlink" title="个人理解"></a>个人理解</h2><p>框架和工具多并不意味着你要去全部学一遍, 但是看到好框架仔细研究不失为一件好事. 就像读书, 读好书提高自己的修养, 然后你以后可以更好地去选书 —- 你也能用这样的方法去选框架. 现在感到迷茫只是因为”读书太少”, 迟早自己会有能力去找到那10%的精华.</p><h2 id="扩展阅读"><a href="#扩展阅读" class="headerlink" title="扩展阅读:"></a>扩展阅读:</h2><p><a href="https://en.wikipedia.org/wiki/Sturgeon%27s_law#cite_note-venture-2" target="_blank" rel="external">Sturgeon’s law</a><br>大概内容是说大部分内容都是垃圾, 但是剩下的10%值得去甄选.</p><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/09/24/why-webpack/">why webpack?</a></h2><div class="meta article-date">2016-09-24</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><h2 id="开篇"><a href="#开篇" class="headerlink" title="开篇"></a>开篇</h2><p>关于Webpack用法我不想讨论太多, 这里是要讨论几个问题</p><ul><li>js模块化工具那么多, 为什么还要有webpack</li><li>和grunt, gulp有什么区别</li><li>可以通过webpack生成一个组件吗</li></ul><a id="more"></a><p>ps:跟官方教材走一遍, 10分钟</p><h2 id="为什么还要webpack-关键是模块化！"><a href="#为什么还要webpack-关键是模块化！" class="headerlink" title="为什么还要webpack, 关键是模块化！"></a>为什么还要webpack, 关键是模块化！</h2><p>关于模块化, 看看这个也许会有更深刻的理解<br><a href="https://github.com/jianghai/blog/issues/2?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io" target="_blank" rel="external">模块化发展史</a></p><p>webpack天生支持CommonJS, 自动打包, 生成单一bundle.js, 在html直接引用即可.</p><p>js可以模块化，那么css呢? 官方教材就告诉你webpack的过人之处<br>[webpack tutorial]<a href="http://webpack.github.io/docs/tutorials/getting-started/" target="_blank" rel="external">http://webpack.github.io/docs/tutorials/getting-started/</a></p><p>打包css的好处? 比如写一个轮播图, 你需要用户自行添加样式, 使用webpack就不需要再麻烦了, 直接打包好.</p><h2 id="与gulp-grunt区别"><a href="#与gulp-grunt区别" class="headerlink" title="与gulp, grunt区别?"></a>与gulp, grunt区别?</h2><p>原来是互补, 后来大家发现gulp能做的, webpack也可以, 而且还做得不错.</p><h2 id="问题-能否用webpack生成一个组件"><a href="#问题-能否用webpack生成一个组件" class="headerlink" title="问题:能否用webpack生成一个组件?"></a>问题:能否用webpack生成一个组件?</h2><p>根据官方教材稍微做了一点修改</p><p>###测试方法<br>修改enrty.js<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="meta">    "use strict"</span>;</div><div class="line"></div><div class="line">    <span class="built_in">require</span>(<span class="string">"!style!css!./style.css"</span>); </div><div class="line">    <span class="built_in">document</span>.write(<span class="built_in">require</span>(<span class="string">"./content.js"</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>打包得到bundle.js, 将bundle.js改名为module.js</p><p>再修改entry.js<br></p><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">require</span>(<span class="string">'./module.js'</span>)();</div></pre></td></tr></table></figure><p></p><p>应该是能得到一样的结果</p><p>然而并不行, 连续两次打包产生了错误, 这样不可以产生可复用的组件以提供其他项目使用.</p><p>ps: 睡醒后发现, 用webpack打包成组件相当愚蠢. 你不是已经写好组件然后用webpack来组装么.</p><h2 id="webpack缺点"><a href="#webpack缺点" class="headerlink" title="webpack缺点"></a>webpack缺点</h2><p>使用sourcemap的调试速度感人[手动再见]</p><h2 id="所以呢"><a href="#所以呢" class="headerlink" title="所以呢?"></a>所以呢?</h2><p>举个例子, 你写了一个轮播图, 想模块化.</p><ul><li>方案1: webpack打包css和js成一个bundle.js, 然后其他人插一个script到html</li><li>方案2: 打包成一个npm, 说明用了CommonJS, 让人家require你的entry.js, 然后人家用webpack打包</li></ul><p>哦~ 太好了,我也理清了思路.</p><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/08/17/HTML5标准下对副标题处理建议/">HTML5标准下对副标题处理建议</a></h2><div class="meta article-date">2016-08-17</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><p>参考: <a href="https://www.w3.org/TR/html5/common-idioms.html#sub-head" target="_blank" rel="external">https://www.w3.org/TR/html5/common-idioms.html#sub-head</a></p><blockquote><p>基本是意译</p></blockquote><a id="more"></a><p>HTML没有提供副标题标签, 下面是替代方案</p><p><code>h1</code> - <code>h6</code> 不能用于表示副标题, 除非是用于表示一个新段落的heading, (unless intended to be the heading for a new section or subsection)</p><p>ps: 后面例子没有说明unless部分的内容是什么意思. 请赐教</p><h2 id="例子-子标题不用hx"><a href="#例子-子标题不用hx" class="headerlink" title="例子(子标题不用hx): "></a>例子(子标题不用<code>hx</code>):</h2><p>下面例子的标题与子标题用<code>header</code>组合(group)到一块, 作者不想让子标题也包含在表格内容中, 而且子标题也不是用于表明新段落(section)的开头, 所以他们用<code>p</code>来表示, 显示效果如下.<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">header</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>HTML 5.1 Nightly<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>A vocabulary and associated APIs for HTML and XHTML<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Editor's Draft 9 May 2013<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">header</span>&gt;</span></div></pre></td></tr></table></figure><p></p><p>结果:<br><img src="https://www.w3.org/TR/html5/images/htmlheading.png" alt="image"></p><h2 id="例子-副标题主标题在同一行"><a href="#例子-副标题主标题在同一行" class="headerlink" title="例子(副标题主标题在同一行):"></a>例子(副标题主标题在同一行):</h2><p>下面例子中的书名, 子标题与和主标题用一个冒号分隔, 然后放到同一行中. 如下:<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>The Lord of the Rings: The Two Towers<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div></pre></td></tr></table></figure><p></p><p>结果:<br><img src="https://www.w3.org/TR/html5/images/lotr.PNG" alt="images"></p><h2 id="例子"><a href="#例子" class="headerlink" title="例子:"></a>例子:</h2><p>用于表示一个专辑名, 通过<code>span</code>和CSS表示子标题<br>(原文:In the following example part of an album title is included in a span element, allowing it to be styled differently from the rest of the title. A br element is used to place the album title on a new line. A sample CSS styled rendering of the heading is provided below the code example.)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Ramones <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Hey! Ho! Let's Go<span class="tag">&lt;/<span class="name">span</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div></pre></td></tr></table></figure><p>结果:<br><img src="https://www.w3.org/TR/html5/images/ramones.png" alt="images"></p><h2 id="例子-1"><a href="#例子-1" class="headerlink" title="例子:"></a>例子:</h2><p>下面例子中, 新闻的题目与摘要(tagline)是<code>header</code>组织, 题目用<code>h2</code>表示, 子标题用<code>p</code>, 效果如下<br></p><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="variable">&lt;header&gt;</span></div><div class="line">   <span class="variable">&lt;h2&gt;</span><span class="number">3</span>D films <span class="built_in">set</span> <span class="keyword">for</span> popularity slide &lt;/h2&gt;</div><div class="line">   <span class="variable">&lt;p&gt;</span>First drop <span class="keyword">in</span> <span class="number">3</span>D box office projected <span class="keyword">for</span> this year despite hotly tipped summer blockbusters,</div><div class="line">    according <span class="keyword">to</span> Fitch Ratings report&lt;/p&gt;</div><div class="line">   &lt;/header&gt;</div></pre></td></tr></table></figure><p></p><p><img src="https://www.w3.org/TR/html5/images/title-tagline.PNG" alt="images"></p><h2 id="例子-2"><a href="#例子-2" class="headerlink" title="例子:"></a>例子:</h2><p>我都懒得写了, 直接上代码<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">header</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Magazine of the Decade<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>THE MONTH<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>The Best of UK and Foreign Media<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></div></pre></td></tr></table></figure><p></p><p><img src="https://www.w3.org/TR/html5/images/themonth.png" alt="images"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>anyway, w3c认为这样处理副标题更加语义化</p><p>另外那么多例子是为了指出可以怎么用, 而不是说有一种可以通用的用法.</p><p>ps: 本文由来: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/hgroup" target="_blank" rel="external">mdn上关于<code>hgroup</code>处理副标题</a> , 指向了 <a href="https://www.w3.org/TR/html5/common-idioms.html#sub-head" target="_blank" rel="external">Subheadings, subtitles, alternative titles and taglines</a></p><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/08/15/轮播图踩坑指南-工作日志/">轮播图踩坑指南 (工作日志)</a></h2><div class="meta article-date">2016-08-15</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><p>好吧, 我终于变回了一个普通码农, 谢天谢地.</p><p>repo: <a href="https://github.com/fulvaz/Carousel-Exercises" target="_blank" rel="external">https://github.com/fulvaz/Carousel-Exercises</a></p><p>具体效果看淘宝首页的轮播图</p><p>总算是写完了一个轮播图, 回想上次面试被人鄙视轮播图都写不好, 我明白了是为什么 —- 真的轮播图都写不好, 基础太差了.</p><p>因为一个轮播图就能涉及到许多问题了, 下面一个个来说明</p><a id="more"></a><h2 id="设计-降低耦合"><a href="#设计-降低耦合" class="headerlink" title="设计, 降低耦合"></a>设计, 降低耦合</h2><p>如果不加任何设计直接写, 结果就是全局变量满天飞, 不同的view之间糅杂到一块, 要想办法将他们分开.</p><p>ps: 虽说是设计, 但是我依旧觉得还是可以继续改进.</p><p>到我这其实只是做了个监听者模式, 将页面逻辑和业务逻辑分离, 顺便说一下这里的页面逻辑是指与页面操作相关的逻辑, 比如说div位置, 动画, 形变等等; 业务逻辑是指, 用户点击了什么, 键盘做了什么操作</p><p>那接下来实现就很简单, 先实现一个监听者, 代码见.</p><p><a href="https://github.com/fulvaz/Carousel-Exercises/blob/master/scripts/observer.js" target="_blank" rel="external">https://github.com/fulvaz/Carousel-Exercises/blob/master/scripts/observer.js</a></p><p>来来回回就那么几个, 订阅, 取消订阅, 发射事件.</p><p>然后新建imgView, buttonView, 并且继承这个监听者, view只要监听事件, 然后处理用户点击时, emmit这个事件就可以了.</p><p>相比而言, 以前需要在处理click事件时还要处理页面逻辑, 不妥.</p><p>举个例子, 我刚开始希望只是点击左右导航, 然后图片相应切换, 没问题, 很容易.</p><p>那么我加这么个需求, 图片下面需要显示一排按钮, 点那个出哪个图片, 并且这排按钮还要通过高亮某个按钮, 指示现在是第几张图片.</p><p>这就日了狗了了啊, 刚才只是两个实体的单向联系:navigator -&gt; imgView, 现在变成了三个实体navigator, imgView, button, 而且联系有navigator-&gt;imgView, navigator-&gt;button, button-&gt;imgView</p><p>最麻烦的是navigator-&gt;button, 你要在原理navigator中修改原来的逻辑, 原来不需要知道第几张, 现在需要了, 要重新处理循环滚动的问题, blablabla</p><p>如果要再加新功能…..联系更多的话……</p><p>所以还不如让他们只是负责自己的工作, 做完传个消息出去.</p><p>话说回来, 这个监听者模式其实是同步监听模式, 即如果在监听某个时间加入耗时操作, 直接页面被艹翻, 嗯, 异步? 说起来, 我深深感觉异步是个陨石坑…和多线程一样…</p><h2 id="异步问题"><a href="#异步问题" class="headerlink" title="异步问题"></a>异步问题</h2><p>我实现循环轮播, 有动画, 并且最后一张到第一张的动画无缝(实现不好就会出现最后一张绕了一大圈回到第一张的情况)</p><p>原理很简单, 比如需要播5张图, 将他们命名为1…5, 实现无缝循环的方法就是在1前面加一张最后一张, 在5后加入第一张, 顺序就会变成[5, 1, 2, 3, 4, 5, 1], 记这个数组为a.</p><p>当处于最后一张5(a[5]), 点击下一张, 那么就是到1(a[6]), 动画是5-&gt;1, 不这样, 动画效果是5-&gt;4-&gt;3-&gt;2-&gt;1</p><p>动画解决了, 动画后, 只需要将a[6]无动画切到a[1]就可以了(直接修改left值).</p><p>然后就踩到异步的坑里面去了.</p><p>我刚开始是利用css的transition属性做的, 那简单对吧<br></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">container</span>.style.left = XX; <span class="comment">// 移动到目标位置</span></div><div class="line"><span class="keyword">container</span>.classList.remove(<span class="string">'animiate'</span>); <span class="comment">// 关掉动画</span></div><div class="line"><span class="keyword">if</span> (到了a[<span class="number">6</span>])</div><div class="line">contianer.style.left = XX; <span class="comment">// 位置改到a[1]</span></div><div class="line"><span class="keyword">container</span>.classList.add(<span class="string">'animate'</span>); <span class="comment">// 开动画</span></div></pre></td></tr></table></figure><p></p><p>问题是, 修改style在浏览器是异步的啊, 而且会打包给你做</p><p>就是说, 你以为人家会乖乖给你按顺序做代码写的, 实际浏览器给你做的是<br></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">contianer.style.left = XX; <span class="comment">// 位置改到a[1]</span></div><div class="line"><span class="keyword">container</span>.classList.add(<span class="string">'animate'</span>); <span class="comment">// 开动画</span></div></pre></td></tr></table></figure><p></p><p>只有这两.</p><p>异步编程保证顺序的方法就是回调, css的动画的回调?</p><p>好吧, 我还是乖乖用requestAnimationFrame<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">offset = <span class="built_in">parseInt</span>(offset);</div><div class="line"><span class="keyword">var</span> start = <span class="literal">null</span>;</div><div class="line"><span class="keyword">var</span> <span class="keyword">from</span> = <span class="built_in">parseInt</span>(<span class="built_in">window</span>.getComputedStyle(target).left);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">handler</span>(<span class="params">ts</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (!start) start = ts;</div><div class="line">    <span class="keyword">var</span> process = ts - start;</div><div class="line">    <span class="keyword">var</span> distance;</div><div class="line">    <span class="keyword">if</span> (offset &gt; <span class="number">0</span>) &#123;</div><div class="line">        distance = <span class="built_in">Math</span>.min(process * speed, offset);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        distance = -<span class="built_in">Math</span>.min(process * speed, -offset);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    target.style.left = <span class="keyword">from</span> + distance + <span class="string">'px'</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (process * speed &lt; <span class="built_in">Math</span>.abs(offset)) &#123;</div><div class="line">        <span class="built_in">window</span>.animateId = <span class="built_in">window</span>.requestAnimationFrame(handler.bind(<span class="keyword">this</span>));</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(callback) &#123;</div><div class="line">        <span class="comment">// 动画结束, 运行回调函数</span></div><div class="line">        callback();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">window</span>.requestAnimationFrame(handler.bind(<span class="keyword">this</span>));</div></pre></td></tr></table></figure><p></p><p>关键点是注释那, 其他代码都是常见的用法.</p><h2 id="动画只有一半-图片只动了一半"><a href="#动画只有一半-图片只动了一半" class="headerlink" title="动画只有一半, 图片只动了一半"></a>动画只有一半, 图片只动了一半</h2><p>因为按太快了, 有些糟糕的教程说是内存问题, 不能按太快 (题外话, 慕课网上的前端教程糟糠多于精华, DW, 糟糕的代码风格和瞎扯, 乖乖去MDN看, 或者买书, 学习总是枯燥的)</p><p>我本来想加一个处理click事件延时, 比如说100ms才能按一次按钮, 但是因为和下面一个问题, 我最后用了另一个方案:</p><p>根本解决方法是给imgView加一个busy属性, 当他在响应某个事件时设置这个标志位, 响应结束再取消</p><h2 id="自动播放与点击"><a href="#自动播放与点击" class="headerlink" title="自动播放与点击"></a>自动播放与点击</h2><p>自动播放很简单, 用setTimeout就可以了(不推荐setInterval, setInterval会堆积任务 — 或者说, 产生奇怪的结果)</p><p>但问题来了, 如果自动播放同时快速点击下一张, 那么图片会变成空白</p><p>解决方法已经说了, 就是加busy属性, 但是setTimout后, 浏览器怎么处理任务?</p><p>首先, 我推测原因是点太快了, 首先我测试了将自动播放间隔变短, 确实直接空白, 是点太快了, 而且原因应该和循环播放有关, 从结果来看是没有重置到最开始的位置, 一直这么循环了下去</p><p>调试证明, 确实有时候没有运行动画后的回调.</p><p>推测: 是动画时间长, setTimout太短打断了动画, 所以我加快的动画速度, 确实没有问题了</p><p>猜测: 动画时间长, 前一个RAF重置了图片位置, 然后就被下一个RAF给改了, 嗯, 这个解释似乎最合情合理.</p><p>根据这个原因, 修改了一下代码, 不加busy判断也可以了.</p><p>原来的代码<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">ImgView.prototype.moveHorizontal = <span class="function"><span class="keyword">function</span>(<span class="params">target, offset, speed, callback</span>) </span>&#123;</div><div class="line">     offset = <span class="built_in">parseInt</span>(offset);</div><div class="line">     <span class="keyword">var</span> start = <span class="literal">null</span>;</div><div class="line">     <span class="keyword">var</span> <span class="keyword">from</span> = <span class="built_in">parseInt</span>(<span class="built_in">window</span>.getComputedStyle(target).left);</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">function</span> <span class="title">handler</span>(<span class="params">ts</span>) </span>&#123;</div><div class="line">         <span class="keyword">if</span> (!start) start = ts;</div><div class="line">         <span class="keyword">var</span> process = ts - start;</div><div class="line">         <span class="keyword">var</span> distance;</div><div class="line">         <span class="keyword">if</span> (offset &gt; <span class="number">0</span>) &#123;</div><div class="line">             distance = <span class="built_in">Math</span>.min(process * speed, offset); <span class="comment">// 已经移动的位移</span></div><div class="line">         &#125; <span class="keyword">else</span> &#123;</div><div class="line">             distance = -<span class="built_in">Math</span>.min(process * speed, -offset);</div><div class="line">         &#125;</div><div class="line"></div><div class="line"></div><div class="line">         target.style.left = <span class="keyword">from</span> + distance + <span class="string">'px'</span>;</div><div class="line">         lastDistance = distance;</div><div class="line"></div><div class="line">         <span class="keyword">if</span> (process * speed &lt; <span class="built_in">Math</span>.abs(offset)) &#123;</div><div class="line">             <span class="built_in">window</span>.animateId = <span class="built_in">window</span>.requestAnimationFrame(handler.bind(<span class="keyword">this</span>));</div><div class="line">         &#125; <span class="keyword">else</span> <span class="keyword">if</span>(callback) &#123;</div><div class="line">             <span class="comment">// 动画结束, 运行回调函数</span></div><div class="line">             callback();</div><div class="line">         &#125;</div><div class="line">     &#125;</div><div class="line">     <span class="built_in">window</span>.requestAnimationFrame(handler.bind(<span class="keyword">this</span>));</div><div class="line"></div><div class="line"> &#125;;</div></pre></td></tr></table></figure><p></p><p>修改后<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">ImgView.prototype.moveHorizontal = <span class="function"><span class="keyword">function</span>(<span class="params">target, offset, speed, callback</span>) </span>&#123;</div><div class="line">     offset = <span class="built_in">parseInt</span>(offset);</div><div class="line">     <span class="keyword">var</span> start = <span class="literal">null</span>;</div><div class="line">     <span class="keyword">var</span> lastDistance = <span class="number">0</span>;</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">function</span> <span class="title">handler</span>(<span class="params">ts</span>) </span>&#123;</div><div class="line">         <span class="keyword">if</span> (!start) start = ts;</div><div class="line">         <span class="keyword">var</span> process = ts - start;</div><div class="line">         <span class="keyword">var</span> currentPos = <span class="built_in">parseInt</span>(<span class="built_in">window</span>.getComputedStyle(target).left);</div><div class="line">         <span class="keyword">var</span> distance;</div><div class="line">         <span class="keyword">if</span> (offset &gt; <span class="number">0</span>) &#123;</div><div class="line">             distance = <span class="built_in">Math</span>.min(process * speed, offset); <span class="comment">// 已经移动的位移</span></div><div class="line">         &#125; <span class="keyword">else</span> &#123;</div><div class="line">             distance = -<span class="built_in">Math</span>.min(process * speed, -offset);</div><div class="line">         &#125;</div><div class="line"></div><div class="line"></div><div class="line">         target.style.left = currentPos + distance - lastDistance + <span class="string">'px'</span>;</div><div class="line">         lastDistance = distance;</div><div class="line"></div><div class="line">         <span class="keyword">if</span> (process * speed &lt; <span class="built_in">Math</span>.abs(offset)) &#123;</div><div class="line">             <span class="built_in">window</span>.animateId = <span class="built_in">window</span>.requestAnimationFrame(handler.bind(<span class="keyword">this</span>));</div><div class="line">         &#125; <span class="keyword">else</span> <span class="keyword">if</span>(callback) &#123;</div><div class="line">             <span class="comment">// 动画结束, 运行回调函数</span></div><div class="line">             target.style.left = <span class="keyword">from</span> + offset + <span class="string">'px'</span>;</div><div class="line">             callback();</div><div class="line">         &#125;</div><div class="line">     &#125;</div><div class="line">     <span class="built_in">window</span>.requestAnimationFrame(handler.bind(<span class="keyword">this</span>));</div><div class="line"></div><div class="line"> &#125;;</div></pre></td></tr></table></figure><p></p><p>主要不同是, 现在每帧动画只要在现在实时位置上添加上一段距离即可</p><p>之前是先记录调用动画时的距离, 每帧根据那个初始距离算出新的图片位置.</p><p>另外callback之前还设置了一下图片的位置, 因为这么改后, 图片位置老是对不上, RAF的过程是无法debug的, 但是debug时位置是对的, 我觉得很有可能是精度被忽略的原因? 还需要研究</p><h2 id="moveHorizontal分析-上述解决冲突方案无效"><a href="#moveHorizontal分析-上述解决冲突方案无效" class="headerlink" title="moveHorizontal分析 (上述解决冲突方案无效)"></a>moveHorizontal分析 (上述解决冲突方案无效)</h2><p>moveHorizontal函数根据图片当前位置和接受到的offset, 然后移动图片.</p><p>当有多个RAF同时调用moveHorizontal时…..之前之所以没出大bug是因为offset都是一样的, 如果offset不同, 比如直接点击按钮, 刚好自动播放也要用, bug就来了</p><p>好吧, 上面说的解决方案其实没用.</p><p>需要保证同时只进行一个RAF, 就是说, 给imgView加锁 — busy属性</p><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/06/22/另一种开发环境-ubuntu-windows/">另一种开发环境- ubuntu + windows</a></h2><div class="meta article-date">2016-06-22</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>用了差不多大半年原生ubuntu,不得不承认一点, ubuntu的gui界面, 或者或ubuntu不适合日常使用. 需要折腾的东西太多太多, 比如不稳定的ss-qt5, 不稳定的chromium(忽然间很卡), 很悲剧的源下载速度, 奇葩的多屏管理(窗口最小化后打不开)……相信我, 不要吐槽我, 你能想到的方案我都差不多试完了.</p><p>吐槽: 我只是没钱买mac<br>update: 已经换mac</p><a id="more"></a><h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><p>最近想写前端, 需要第三个显示器, 网上的usb-vga转换器只能在windows下使用, 有个哥们尝试实现了一下驱动, 然而项目已经放弃了, 让我去学驱动开发也不现实.</p><p>linux的最强的功能是命令行. 这是我最不想放弃的一部分, cygwin也不能代替. 如果可以在windows的gui环境下还能使用linux的命令行, 那是极好的.</p><p>连vps的方案先否决, 连国内不经济(学生套餐?不好用), 国外太慢. 那就直接virtualbox运行ubuntu server吧!</p><h2 id="唯一的坑"><a href="#唯一的坑" class="headerlink" title="唯一的坑"></a>唯一的坑</h2><p>唯一的坑是连接方式要选<code>网络地址转换(NAT)</code>, 还要做端口转发<code>设置-网络-端口转发</code>.<br>其次, 开发的时候注意监听0.0.0.0, 而不是以前的localhost<br>嗯…我怎么又想到了安全问题?</p><h2 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h2><p>会持续更新</p><ol><li>源太慢就用迅雷下好了, 用winscp传到服务器手动装</li><li>ubuntu server安装增强功能,共享目录<br><code>http://devtidbits.com/2010/03/11/virtualbox-shared-folders-with-ubuntu-server-guest/</code></li><li>更好的方案是使用vagrant, 但我已经配好了一个镜像, 不想重新弄了, 我先缓一缓再去折腾, 感觉不难, 就是需要时间</li></ol><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/06/18/稍微加快实验室网速/">稍微加快实验室网速</a></h2><div class="meta article-date">2016-06-18</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>我在当年考研, 听说暨大网速好,就报了.结果网速真的很快, 除了实验室<br>update: 极路由下个VPN插件就能搭VPN服务器了<br>update: 然后最近快得不行, 不知道哪位大爷放过了我们</p><a id="more"></a><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>首先考虑是不是实验室路由器到上级路由出口带宽太小. 这个好解决, 找个人少的时间重置了实验室路由器, 重新配置了qos, 然后在高峰时段在路由器后台监控流量……嗯, 峰值200k.</p><p>那很有可能是公网出口带宽太小—-分配到实验室路由器的公网带宽太小. 哪里可以拿到额外的公网带宽? 宿舍. 如果可以在宿舍建一个代理服务器, 然后从实验室连接到宿舍, 通过宿舍的公网带宽连公网的话, 速度无疑会快很多.</p><h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><p>由于直接在路由器上做文章限制很多, 最有效可行的方案就是用ssh转发, 然后用proxifier对系统进行全局代理 (ubuntu可以直接设置)<br>ps:当然你也可以放台电脑在宿舍, 然后在windows下面建一个http服务器, 那更简单也更稳定, 毕竟有官方支持的客户端, 网上建http服务器的教程很多,可以去搜索下</p><h2 id="干活"><a href="#干活" class="headerlink" title="干活"></a>干活</h2><p>###ping<br>首先在实验室ping宿舍ip, 可以ping通, ping值1ms</p><p>###准备路由器<br>我用极路由, 其他openwrt路由器也可以, mentohust老习惯性掉线, 本想写脚本通过ping来判断掉线, 然后自动掉线重连, 但是觉得这完全没有必要, 直接半小时重启一次mentohust即可</p><p>###自动重启mentohust<br>用putty连接路由器<br>输入<br></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi <span class="regexp">/etc/</span>cront<span class="regexp">/root</span></div></pre></td></tr></table></figure><p></p><p>在最后加入<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="emphasis">*/30 *</span> <span class="bullet">* *</span> * mentohust -k</div><div class="line"><span class="emphasis">*/30 *</span> <span class="bullet">* *</span> * mentohust</div></pre></td></tr></table></figure><p></p><p>这个脚本的意思是每半个关闭mentohust, 然后启动mentohust</p><p>###端口转发<br>极路由可以去下一个叫超级端口转发的插件, 然后dmz自己路由器的地址, 极路由是192.168.199.1, 其他路由自行想办法dmz</p><p>###用putty生成socks5</p><p>###用proxifier全局代理<br>嗯….网上一堆, 我就不写了</p><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>###全局代理后shadowsocks连不上了!<br>在路由器上搭好梯子, 然后弄出socks5, 自己远程连接</p><p>###安全性问题呢? 路由器不是暴露到公网上了?<br>嗯. 暨大是文科学校, 信科院也搬到南校区去了,我在本校. 按理说我毕业前都不会是个问题. XD</p><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/06/18/npm进阶-补漏/">npm进阶(补漏)</a></h2><div class="meta article-date">2016-06-18</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><p>为自己的迷茫期背锅, 重新学习node, 多说几句, 在我看来node根本不是个适合的服务端工具, node只是个为前端服务的工具(至少现在看来), 既然糊里糊涂进了这个坑, 我也就懒得走了, 继续蹲下去. 我的目标是前端, 但不至于前端, 更重要是会使用node制作工具和轮子更好地开发前端.</p><p>也许还需要补充基础知识, 必要时跑后端去, <strong>语言真的不是关键</strong>, 但我需要知识的深度和专精.</p><p>(看不到图? 插件还没写好啊)</p><a id="more"></a><hr><p>##更新package</p><p>npm update 更新</p><p>npm outdated 测试是否有旧版本的包</p><p>##语义化版本管理</p><p><code>~</code> 忽略minor版本, 比如<code>~1.2.0</code>可以升级到<code>1.2.4</code>但是不能升级到<code>1.3.0</code>, 忽略minor升级</p><p><code>^</code> 忽略major版本升级</p><p>ps: 如果需要升级major版本的话, 需要删除依赖, 然后重新安装</p><p>##scoped package</p><p>以<code>@</code>开头的包, 比如说<code>usrename/package</code></p><p>###新建</p><p><code>npm init --scope=username</code></p><h3 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h3><p>一般这种包都是私有的, 如果需要发布成公共包</p><p><code>npm publish --access=public</code></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><code>npm install @username/project-name --save</code></p><p>一样</p><h1 id="How-npm-works"><a href="#How-npm-works" class="headerlink" title="How npm works"></a>How npm works</h1><h2 id="npm2"><a href="#npm2" class="headerlink" title="npm2"></a>npm2</h2><p>查看依赖树: <code>npm ls</code></p><p>只看主要依赖’npm ls –depth=0’</p><p>你每一个依赖的依赖都会被冗余放置, 比如说, 你导入了a, b两个包, a依赖c, b也依赖c, 那么你的依赖目录里面会存在两个c, c是冗余的</p><h2 id="npm3"><a href="#npm3" class="headerlink" title="npm3"></a>npm3</h2><p>npm3变得更加扁平了, 而非npm2那样的嵌套, 同时npm会根据安装顺序处理依赖</p><p><img src="https://leanote.com/api/file/getImage?fileId=5765638aab64415bec0059a9" alt=""></p><p>还是这个例子, B1.0已经安装, 如果需要导入一个依赖B的C, 则处理如下:</p><p><img src="https://leanote.com/api/file/getImage?fileId=5765638aab64415bec0059aa" alt=""></p><p>但这并不意味着npm解决了全部问题, 比如再安装一个D模块</p><p><img src="https://leanote.com/api/file/getImage?fileId=5765638aab64415bec0059ab" alt=""></p><p>B依然会重复, 因为B2.0无法安装在最高层</p><h3 id="将B放到顶层"><a href="#将B放到顶层" class="headerlink" title="将B放到顶层"></a>将B放到顶层</h3><p>需要先将全部依赖B1.0的包更新为B2.0, 然后运行<code>npm dedupe</code></p><h3 id="Non-determinism"><a href="#Non-determinism" class="headerlink" title="Non-determinism"></a>Non-determinism</h3><p>install order matters, 就是说, 在npm3里面, 不同环境的依赖树可能是不一样的, 比如像上面例子那样A更新了B的版本, 导致后续模块对B的依赖都是指向顶层的B, 而非嵌套的B</p><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/06/14/重构之痛/">重构之痛</a></h2><div class="meta article-date">2016-06-14</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><p>好吧, 之前的百度IFE的图片库偷懒不写完, 然后想进行重构, 结果扯到蛋了,脚步太大<br><a id="more"></a></p><p>脚步太大</p><hr><p>Webpack - 模块化</p><p>Babel - ES6</p><p>主要是这两个坑, 将ES5代码转到ES6修改太大, 那么不可避免就会引入bug, 本来是没事的, 有bug就调呗, 反正项目也不大, 100行代码而已. 然而后面的事情证明我太傻太天真.</p><p>Webpack + Babel调试问题</p><hr><p>好的, Babel和Webpack帮我将100行代码转成了1000行的大怪物. 嗯, 怎么调呢? 机智的我当然记起sourcemap, 可惜现实是残酷的, sourcemap似乎对CommonJS支持有问题, 结果是明明文件A报错, 提示信息变到了B上面去了.</p><p>简而言之, 没法debug了.</p><p>没单元测试</p><hr><p>按照我想实现的目标的话, 单元测试有没有根本不重要啊, 即使是之前写了, 现在变ES6也用不上了</p><p>What to do?</p><hr><ol><li><p>等待, 需要等待一个时机, 就像前端入坑一样.</p></li><li><p>深入学习Webpack和Babel, 毕竟现在这两样东西对我而言还是黑魔法, 最近一个论调让我觉得很无奈, “学习使用工具的时间比编程本身的时间还要多”, well, 我认为先深入完几个工具, 未来的工具也就那样吧.</p></li><li><p>现在沉没成本已经很高了, 随便换坑实在得不偿失.</p></li></ol><h2 id="update"><a href="#update" class="headerlink" title="update"></a>update</h2><p>如果只用es6的import和export是可以正常调试的, 猜测原因是Babel本身就会将import/export转换为CommonJS.</p><p>Next</p><hr><p>我先去做下native, 再考虑这个大坑 - -!</p><p>主要是调节下心情</p><p>PS</p><hr><p>顺便主页在移动端下的Banner视频给删掉了, 根本用不了</p><!-- rebuild by neat --></div></article></li><li class="reveal-detect"><article><div class="article-head"><h2 class="article-title"><a href="/2016/06/02/haha/">haha</a></h2><div class="meta article-date">2016-06-02</div></div><!-- abstract--><div class="article-content markdown-body"><!-- build time:Sat Jun 24 2017 17:11:19 GMT+0800 (CST) --><img title="图片标题" alt="图片说明" class="class1 class2" src="http://7xp7jw.com1.z0.glb.clouddn.com/static/images/test.jpg?imageView2/2/w/600"><a id="more"></a><!-- rebuild by neat --></div></article></li></ul></section><footer id="page-footer"><nav id="footer-menu"><ul><li><a href="/about">About</a></li><li><a href="/archives">Archive</a></li><li><a href="https://github.com/fulvaz/hexo-theme">Source</a></li></ul></nav></footer></div><script src="/script/futil.min.js"></script><script src="/script/app_0.1.min.js"></script></body></html>